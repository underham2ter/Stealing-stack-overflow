{% extends 'main/base.html' %}

{% load question_filters %}

{% block title %}
Question
{% endblock %}

{% block content %}
<div class="container">
    <div id="content" class="snippet-hidden">
        <div class="inner-content clearfix">

                <div id="question-header" class="d-flex sm:fd-column">
                            <h1 itemprop="name" class="fs-headline1 ow-break-word mb8 flex--item fl1">{{ question.title }}</h1>
                    <div class="ml12 aside-cta flex--item print:d-none sm:ml0 sm:mb12 sm:order-first sm:as-end">
                            <a href="/questions/ask" class="ws-nowrap s-btn s-btn__primary">
            Ask Question
        </a>

                    </div>
                </div>

                <div class="d-flex fw-wrap pb8 mb16 bb bc-black-075">
                        <div class="flex--item ws-nowrap mr16 mb8">
                            <span class="fc-light mr2">Added on</span>
                            <time itemprop="dateCreated">{{ question.added_at|date:'SHORT_DATE_FORMAT' }}</time>
                        </div>
                        <div class="flex--item ws-nowrap mr16 mb8">
                            <span class="fc-light mr2">by</span>
                            {{ question.author }}
                        </div>
    <!--                    <div class="flex&#45;&#45;item ws-nowrap mb8" title="Viewed 2 times">-->
    <!--                        <span class="fc-light mr2">Viewed</span>-->
    <!--                        2 times-->
    <!--                    </div>-->
                </div>
                <div role="main" aria-label="question and answers">


    <div class="question">
<!--rating buttons-->
        <div class="post-layout">
            <div class="votecell post-layout--left">
                <div class="js-voting-container d-flex jc-center fd-column ai-stretch gs4 fc-black-200">

            <button class="js-vote-up-btn flex--item s-btn s-btn__unset c-pointer"
                    id = "upvote"
                    {% if already_liked %}
                    style="color: orangered;"
                    {% else %}
                    style="color: lightgrey;"
                    {% endif %}
                    data-controller="s-tooltip"
                    data-s-tooltip-placement="right"
                    title="This question shows research effort; it is useful and clear"
                    aria-pressed="false"
                    aria-label="Up vote"
                    data-selected-classes="fc-theme-primary"
                    data-unselected-classes="">
                <svg aria-hidden="true" class="svg-icon iconArrowUpLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 25h32L18 9 2 25Z"/></svg>
            </button>
            <div class="js-vote-count flex--item d-flex fd-column ai-center fc-black-500 fs-title"
                 itemprop="upvoteCount"
                 id="rating">

                {{ question.rating }}

            </div>
            <button class="js-vote-down-btn flex--item s-btn s-btn__unset c-pointer "
                    id = "downvote"
                    data-controller="s-tooltip"
                    data-s-tooltip-placement="right"
                    {% if already_disliked %}
                    style="color: orangered;"
                    {% else %}
                    style="color: lightgrey;"
                    {% endif %}
                    title="This question does not show any research effort; it is unclear or not useful"
                    aria-pressed="false"
                    aria-label="Down vote"
                    data-selected-classes="fc-theme-primary"
                    data-unselected-classes="">
                <svg aria-hidden="true" class="svg-icon iconArrowDownLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 11h32L18 27 2 11Z"/></svg>
            </button>

            <button class="js-bookmark-btn s-btn s-btn__unset c-pointer py4 js-gps-track"
                    data-controller="s-tooltip" data-s-tooltip-placement="right" title="Bookmark this question."
                    aria-pressed="false" aria-label="Bookmark" data-selected-classes="fc-yellow-600"
                    data-gps-track="post.click({ item: 1, priv: -1, post_type: 1 })">
                <svg aria-hidden="true" class="svg-icon iconBookmark" width="18" height="18" viewBox="0 0 18 18"><path d="M6 1a2 2 0 0 0-2 2v14l5-4 5 4V3a2 2 0 0 0-2-2H6Zm3.9 3.83h2.9l-2.35 1.7.9 2.77L9 7.59l-2.35 1.7.9-2.76-2.35-1.7h2.9L9 2.06l.9 2.77Z"/></svg>
                <div class="js-bookmark-count mt4 d-none" data-value=""></div>
            </button>



            <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/71720361/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18" viewBox="0 0 19 18"><path d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4h3L3 9Zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10V5Z"/></svg></a>

    </div>
            </div>



    <div class="postcell post-layout--right">

        <div class="s-prose js-post-body" itemprop="text">
                {{ question.text }}
        </div>

        <div class="mb0 ">
            <div class="mt16 d-flex gs8 gsy fw-wrap jc-end ai-start pt4 mb16">
                <div class="flex--item mr16 fl1 w96">

                </div>


            </div>
        </div>
    </div>




                <span class="d-none" itemprop="commentCount"></span>
        <div class="post-layout--right js-post-comments-component">
            <div id="comments-71720361" class="comments js-comments-container bt bc-black-075 mt12  dno" data-post-id="71720361" data-min-length="15">
                <ul class="comments-list js-comments-list"
                        data-remaining-comments-count="0"
                        data-canpost="false"
                        data-cansee="true"
                        data-comments-unavailable="false"
                        data-addlink-disabled="true">

                </ul>
            </div>

            <div id="comments-link-71720361" data-rep=50 data-reg=true>
                    <span class="js-link-separator dno">&nbsp;|&nbsp;</span>
                <a class="js-show-link comments-link dno" title="Expand to show all comments on this post" href=# onclick="" role="button"></a>
            </div>
        </div>
        </div>

    </div>



                    <div id="answers" class="no-answers">
                        <a name="tab-top"></a>
                        <div id="answers-header">
                            <div class="answers-subheader d-flex ai-center mb8">
                                <div class="flex--item fl1">
                                    <h2 class="mb0" data-answercount="0">
                                        {% if question.q_to_ans.all%}
                                        {{question.q_to_ans.count|add_text:'Answer'}}
                                        {% endif %}
                                        <span style="display:none;" itemprop="answerCount">0</span>
                                    </h2>
                                </div>
                                <div class="flex--item d-none">



                                </div>
                            </div>

                        </div>

{% for answer in question.q_to_ans.all %}
    <div class="answercell post-layout--right">
        <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">
            <div class="user-info ">
                <div class="user-action-time">
                    {{answer.author}} answered <span class="relativetime">{{answer.added_at|time_difference}}:</span>
                </div>
            </div>
        </div>


        <div class="s-prose js-post-body" itemprop="text">
            <p>{{answer.text}} </p>
        </div>
        <div class="mt24">
            <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">
                <div class="flex--item mr16" style="flex: 1 1 100px;">
                </div>
            </div>
        </div>

{% endfor %}

<form id="post-form"  method="post" class="js-add-answer-component post-form">

    <h2 class="space">
        Your Answer
    </h2>

    <div class="ps-relative">
            <div class="wmd-container mb8">
                <div class="js-stacks-validation">
                    {% for e in form.non_field_errors %}
                    <div class="alert alert-danger">{{ e }}</div>
                    {% endfor %}
                        <div class="ps-relative">
    <!--                        !important-->
                            {% csrf_token %}
                            {{ form.text|add_id:"wmd-input"}}
                        </div>

                        <div class="s-input-message mt4 d-none js-stacks-validation-message"></div>

                    </div>
                </div>
            </div>

            <div class="form-submit cbt d-flex gsx gs4">
                <button id="submit-button" class="flex--item s-btn s-btn__primary s-btn__icon" type="submit" name="answer_submit" tabindex="120">
                    Post Your Answer
                </button>

            </div>

</form>





                    </div>
                </div>
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('#upvote').click(function(){
    $.ajax({
             type: "POST",
             url: '',
             data: {'operation':'upvote','csrfmiddlewaretoken': '{{ csrf_token }}'},
             dataType: "json",
             success: function(response) {
                    dv_button = document.getElementById('downvote')
                    uv_button = document.getElementById('upvote')

                    if(response.liked===true){
                        $(uv_button).css("color","orangered");
                        $(dv_button).css("color","lightgrey");
                    }
                    else if(response.liked===false){
                        $(uv_button).css("color","lightgrey");
                    }
                    $('#rating').text(response.rating)


              }

        });

  })

$('#downvote').click(function(){
    $.ajax({
             type: "POST",
             url: '',
             data: {'operation':'downvote','csrfmiddlewaretoken': '{{ csrf_token }}'},
             dataType: "json",
             success: function(response) {
                    dv_button = document.getElementById('downvote')
                    uv_button = document.getElementById('upvote')
                    if(response.disliked===true){
                        $(dv_button).css("color","orangered");
                        $(uv_button).css("color","lightgrey");
                    }
                    else if(response.disliked===false){
                        $(dv_button).css("color","lightgrey");
                    }
                    $('#rating').text(response.rating)


              }

        });

  })
</script>
{% endblock %}